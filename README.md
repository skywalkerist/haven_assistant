# Haven Demo - 智能机器人控制系统

一个基于 uni-app 框架开发的智能机器人管控平台，集成语音识别、人脸识别、物品配送、安防巡逻等多种智能功能。

## 📋 项目简介

Haven Demo 是一个综合性的机器人控制应用，为用户提供了直观的界面来管理和控制智能机器人。应用支持多平台部署（Android、iOS、微信小程序等），并通过云端服务实现实时任务下发与状态监控。

## ✨ 主要特性

### 🤖 核心功能
- **机器人状态监控** - 实时查看机器人状态、位置、电量信息
- **任务下发系统** - 支持多种任务类型的远程下发与执行
- **语音交互** - 语音识别、语音合成、个性化语音克隆
- **人脸识别** - 人脸录入与识别管理
- **智能巡逻** - 安防巡逻路线设置与执行
- **物品配送** - 自动化物品运送服务

### 🎯 应用模块
- **控制中心** - 机器人状态展示与基础控制
- **警告系统** - 安全警报与状态提醒
- **用户管理** - 用户信息与权限管理
- **聊天交互** - 智能对话与语音交流
- **个性设置** - 机器人个性化配置
- **语音管理** - 声音音色与语音模型管理
- **计算服务** - 云端计算功能

## 🏗️ 技术架构

### 前端技术栈
- **框架**: uni-app (Vue 3)
- **开发工具**: HBuilderX
- **UI组件**: 自定义组件库
- **状态管理**: Vue 3 Composition API

### 后端服务
- **云服务**: uniCloud (阿里云)
- **数据库**: MongoDB (云数据库)
- **云函数**: Node.js serverless 函数
- **文件存储**: 云存储服务

### 云函数列表
```
├── add                     # 添加数据
├── cleanupExpiredCommands # 清理过期任务
├── getCommandResult       # 获取任务执行结果
├── getVoices              # 获取语音列表
├── pollCommand            # 轮询任务状态
├── postCommand            # 提交任务命令
├── sendMessage            # 发送消息
├── setDefaultVoice        # 设置默认语音
├── uploadAudio            # 上传音频文件
└── uploadAudioForASR      # 上传音频进行语音识别
```

## 📱 支持平台

- ✅ Android App
- ✅ iOS App  
- ✅ 微信小程序
- ✅ 支付宝小程序
- ✅ 百度小程序
- ✅ 字节跳动小程序

## 🚀 快速开始

### 环境要求
- HBuilderX 3.0+
- Node.js 14+
- uniCloud 开发者账号

### 安装步骤

1. **克隆项目**
   ```bash
   git clone [项目地址]
   cd haven_demo
   ```

2. **打开项目**
   - 使用 HBuilderX 打开项目目录
   - 配置 uniCloud 环境

3. **配置云服务**
   - 在 uniCloud 控制台创建服务空间
   - 关联项目到服务空间
   - 上传云函数和云数据库结构

4. **运行项目**
   - 开发环境：选择运行到浏览器/模拟器
   - 生产环境：打包发布到各平台

### 目录结构
```
haven_demo/
├── components/          # 自定义组件
├── pages/              # 页面文件
│   ├── index/          # 首页（控制中心）
│   ├── safety/         # 警告页面
│   ├── user/           # 用户管理
│   ├── chat/           # 聊天对话
│   ├── voice_cloning/  # 语音克隆
│   ├── voice_management/ # 语音管理
│   ├── face_entry/     # 人脸录入
│   ├── delivery/       # 物品配送
│   ├── patrol/         # 安防巡逻
│   ├── personalization/ # 个性设置
│   └── calculator/     # 云端计算器
├── static/             # 静态资源
├── uniCloud-aliyun/    # 云端代码
│   ├── cloudfunctions/ # 云函数
│   └── database/       # 数据库结构
├── uni_modules/        # uni-app 模块
├── App.vue            # 应用入口
├── main.js            # 入口文件
├── manifest.json      # 应用配置
└── pages.json         # 页面配置
```

## 🔧 配置说明

### 应用配置 (manifest.json)
- 应用名称：haven_demo
- 应用ID：__UNI__73C8DF0
- 版本号：1.0.0

### 权限配置
应用申请的 Android 权限：
- 网络访问权限
- 相机权限
- 存储权限
- 设备状态权限
- WiFi状态权限

## 🎨 界面预览

应用采用现代化的 UI 设计，包含：
- 沉浸式背景设计
- 卡片式布局
- 直观的图标系统
- 响应式界面适配

## 📊 数据模型

### 机器人命令表 (robot_commands)
```json
{
  "task": "任务名称",
  "params": "任务参数",
  "status": "任务状态", // pending, processing, completed, failed
  "result": "执行结果",
  "error_message": "错误信息",
  "created_at": "创建时间",
  "updated_at": "更新时间"
}
```

### 机器人状态表 (robot_status)
- 机器人基本状态信息
- 位置信息
- 电量状态
- 任务执行状态

### 消息表 (messages)
- 用户与机器人的对话记录
- 系统消息与通知
- 语音消息处理

## 🔄 核心工作流程

1. **任务下发流程**
   - 用户在界面选择任务
   - 调用 `postCommand` 云函数提交任务
   - 系统将任务写入 `robot_commands` 表
   - 机器人端轮询获取待执行任务

2. **状态监控流程**
   - 应用定时调用 `pollCommand` 查询任务状态
   - 实时更新界面显示
   - 处理任务完成或失败的回调

3. **语音交互流程**
   - 录音 → 上传云端 → 语音识别 → 指令解析 → 任务执行
   - 文本转语音 → 个性化语音合成 → 音频播放

## 🛠️ 开发指南

### 添加新功能模块
1. 在 `pages/` 目录下创建新页面
2. 在 `pages.json` 中注册页面路由
3. 如需云端支持，在 `uniCloud-aliyun/cloudfunctions/` 添加对应云函数
4. 更新数据库结构（如必要）

### 自定义组件开发
- 组件放置在 `components/` 目录
- 遵循 uni-app 组件开发规范
- 支持多平台兼容性

### 云函数开发
- 使用 Node.js 开发
- 支持 async/await 语法
- 统一错误处理和返回格式

## 🔒 安全考虑

- 云函数权限控制
- 用户身份验证
- 数据传输加密
- 敏感信息保护

## 📈 性能优化

- 图片资源优化
- 懒加载实现
- 云函数冷启动优化
- 数据库查询优化

## 🐛 故障排除

### 常见问题
1. **云函数调用失败**
   - 检查网络连接
   - 验证云服务空间配置
   - 查看云函数日志

2. **页面加载异常**
   - 清除缓存重新运行
   - 检查静态资源路径
   - 验证页面配置项

3. **多平台兼容性问题**
   - 查阅 uni-app 官方文档
   - 使用条件编译处理平台差异
   - 测试各平台特性支持

## 📝 更新日志

### v1.0.0 (当前版本)
- 初始版本发布
- 实现核心机器人控制功能
- 集成语音、人脸识别等AI功能
- 支持多平台部署

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request 来改进项目。

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 项目 Issues: [GitHub Issues]
- 邮箱: [开发者邮箱]

---

*本项目基于 uni-app 框架开发，致力于为智能机器人提供专业的控制管理解决方案。*